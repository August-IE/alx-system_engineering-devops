#!/usr/bin/env bash
# A script that installs nginx on my web-01 server:
# Nginx should be listening on port 80.
# It should return a page that contains the string "Hello World!" at the root
# with a curl GET request.

sudo apt-get -y update
sudo apt-get install -y nginx

ufw allow 'Nginx HTTP'

mkdir /var/www/html
echo "Hello World!" > /var/www/html/index.html

# Ensure nginx is listening on port 80
awk '/listen 80/ {$2=""; print "listen 80;"}' /etc/nginx/sites-available/default > /etc/nginx/sites-available/default.tmp && mv /etc/nginx/sites-available/default.tmp /etc/nginx/sites-available/default

sudo service nginx restart
